
ext.genDir = "gen"

project.buildDir = "../${rootProject.ext.genDir}/$project.name"
println "setting root project $project.name build dir to: $project.buildDir"

project.ext {
  idePrefix = "${rootProject.buildDir}/../gradle-idea/"

  deployRepoUri = '../../shorn.bitbucket.org/maven'
  snapshotRepoUri = "${rootProject.buildDir}/../repo"
}

allprojects { Project iProject ->
  apply plugin: 'idea'
  apply plugin: 'maven'

  repositories {
    mavenCentral()
  }

idea.module.outputFile = file("${rootProject.ext.idePrefix}/${iProject.name}.iml")


}

idea {
  tasks.ideaWorkspace.outputFile =
    file("${rootProject.ext.idePrefix}/${rootProject.name}.iws")
  project {
    languageLevel = '1.6'
    outputFile = file("${rootProject.ext.idePrefix}/${rootProject.name}.ipr")
  }  
}


subprojects { Project iProject ->
  apply plugin: 'groovy'

  iProject.buildDir = "$rootProject.ext.genDir/$iProject.name"

  dependencies {
    compile gradleApi()
    compile localGroovy()
    testCompile 'junit:junit:4.+' 
  }

}

project(':eclipsei2g'){
  group = 'eclipsei2g'
  version = '0.0.1-SNAPSHOT'

task sourceJar(type: Jar) {
  classifier = 'sources'
  from sourceSets.main.allSource
}

artifacts {
  archives sourceJar
}

uploadArchives {
  repositories {
    mavenDeployer {
      repository(url: uri(rootProject.ext.deployRepoUri))
      snapshotRepository(url: uri(rootProject.ext.snapshotRepoUri))
    }
  }
}

}







